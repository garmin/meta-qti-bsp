From d32236b846f066596bd86347f32603c7d613bc27 Mon Sep 17 00:00:00 2001
From: Hao Li <haolia@codeaurora.org>
Date: Tue, 11 Feb 2020 22:16:34 +0800
Subject: [PATCH] systemd: skip smack copy failed

skip smack copy failed

Signed-off-by: Hao Li <haolia@codeaurora.org>
---
 src/core/mount-setup.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/core/mount-setup.c b/src/core/mount-setup.c
index ea7b0a8..0f25459 100644
--- a/src/core/mount-setup.c
+++ b/src/core/mount-setup.c
@@ -277,7 +277,10 @@ static int symlink_controller(const char *target, const char *alias) {
 
         r = mac_smack_copy(a, p);
         if (r < 0 && r != -EOPNOTSUPP)
-                return log_error_errno(r, "Failed to copy smack label from %s to %s: %m", p, a);
+        {
+                log_error_errno(r, "Failed to copy smack label from %s to %s: %m", p, a);
+        }else if (errno != EEXIST)
+                return log_error_errno(errno, "Failed to create symlink %s: %m", t);
 #endif
 
         return 0;
-- 
2.7.4

